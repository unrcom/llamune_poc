# llamune_poc 設計書

## 概要

ユーザーが特定の事業領域に関する会話を閉域LLMまたはトレーニング中のLLMと行い、回答を評価・記録するアプリケーションです。

## 利用フロー

1. ユーザーがAPIキーを使ってセッションを開始（PoC・モデル・システムプロンプトを設定）
2. ユーザーが質問を入力し、LLMが回答を返す（1問1答、マルチターンなし）
3. ユーザーが回答を評価（良い／不十分／間違い）
4. 不十分・間違いの場合は理由と正しい回答を入力
5. 記録されたデータが llamune_learning に引き渡される

## 技術スタック

| コンポーネント | 技術 |
|---|---|
| フロントエンド | Node.js 系フレームワーク（`web/` ディレクトリ） |
| バックエンド | Python 3.11 / FastAPI |
| LLM推論 | MLX（Apple Silicon）|
| データベース | PostgreSQL 16（ローカル） |
| 認証 | APIキー（X-API-Key ヘッダー） |
| マイグレーション | Alembic |

## llamune_learning との連携

llamune_poc と llamune_learning は同じローカルPostgreSQLを共有します。

1. llamune_poc でユーザーが会話・評価を記録（status = 1: 未処理）
2. llamune_learning が status = 1 のレコードを取得して訓練データを生成
3. 訓練データ生成後に status = 2（訓練済み）に更新
4. ファインチューニング済みモデルを models テーブルに登録（version を更新）
5. llamune_poc に戻って新バージョンのモデルで再テスト

## 今後の検討事項

| 項目 | 内容 |
|---|---|
| 訓練データ自動生成 | LLMによるたたき台生成（llamune_learning Phase 2） |
| 外部委託ワークフロー | 外部組織による訓練データレビュー・承認フロー |
| マルチドメイン対応 | PoCでは単一ドメイン、将来的に複数ドメイン対応 |
| 本番認証 | PoC後はJWT認証への移行を検討 |
